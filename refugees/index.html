<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <title>Refugee Crisis</title>
    <script src="http://s.codepen.io/assets/libs/modernizr.js" type="text/javascript"></script>

    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/style.css">
    
  </head>

  <style>
    .IRR { fill: #ddc; }
    .IRK { fill: #ddc; }
    .SYU { display: none; }
    .SYX { fill: #FFCC00; }
    .selected { fill: yellow; }


    .subunit-boundary {
      fill: none;
      stroke: #777;
      stroke-dasharray: 2,2;
      stroke-linejoin: round;
    }

    .subunit-label {
      fill: #777;
      fill-opacity: .5;
      font-size: 20px;
      font-weight: 300;
      text-anchor: middle;
    }


    path { 
        stroke: steelblue;
        stroke-width: 2;
        fill: none;
    }

    .axis path,
    .axis line {
        fill: none;
        stroke: grey;
        stroke-width: 1;
        shape-rendering: crispEdges;
    }
  </style>


  <body>

  <div class="container">
  
  <section>
    <div class="image" data-type="background" data-speed="2"></div>
    <div class="stuff" data-type="content">
      <h1>Refugee Crisis</h1>
      <h3>by Eric Hagen, Rob Kuvinka, Reema Naqvi</h3></div>
  </section>

  <section>
    <div class="image" data-type="background" data-speed="7"></div>
    <!-- <p id="tableau-header">Some Title</p>   Why are the two blocks inline -->
    <div  id="tableau1" data-type="content">  <!--Removed class="stuff" to get rid of orange lines-->
       <!-- <h2>lets try a picture</h2>  If removed, tableau aligns vertically -->
      <!-- Tableau embed code from the server -->
       <script type='text/javascript' src='https://public.tableau.com/javascripts/api/viz_v1.js'></script>
       <div class='tableauPlaceholder' style='width: 1004px; height: 869px;'>
         <noscript>
           <a href='#'>
           <img alt='Dashboard 1 ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Im&#47;Immigration_12&#47;Dashboard1&#47;1_rss.png' style='border: none' />
           </a>
           </noscript>
           <object class='tableauViz' width='1004' height='869' style='display:none;'>
             <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
             <param name='site_root' value='' />
             <param name='name' value='Immigration_12&#47;Dashboard1' />
             <param name='tabs' value='no' />
             <param name='toolbar' value='yes' />
             <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Im&#47;Immigration_12&#47;Dashboard1&#47;1.png' /> 
             <param name='animate_transition' value='yes' />
             <param name='display_static_image' value='yes' />
             <param name='display_spinner' value='yes' />
             <param name='display_overlay' value='yes' />
             <param name='display_count' value='yes' />
             <param name='showTabs' value='y' />
          </object>
        </div>
    </div>
  </section>

<!--   <section>
    <div class="image" data-type="background" data-speed="6"></div>
    <div class="stuff" data-type="content">whats here?</div>
  </section> -->

<!--   <section>
    <div class="image" data-type="background" data-speed="5"></div>
    <div class="stuff" data-type="content">some more shit</div>
  </section> -->

  <section>
    <div class="image" data-type="background" data-speed="3"></div>
    <div class="stuff" data-type="content">goes over 2nd image</div>
  </section>

  <section>
    <div class="image" data-type="background" data-speed="3"></div>
    <div class="stuff" data-type="content">  <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script></script>
  <script src="//d3js.org/topojson.v1.min.js"></script>
  <script src="jquery-1.12.0.min.js"></script>
  <script>

  var width = 1320,
      height = 742
      padding = 100;

  var projection = d3.geo.albers()
      .center([0, 30.5])
      .rotate([-52, 0])
      .parallels([32, 39])
      .scale(1200 * 2)
      .translate([width / 2, height / 2]);

  var path = d3.geo.path()
      .projection(projection);

  var svg = d3.select("body").append("svg")
      .attr("width", width)
      .attr("height", height);


  var data = [50,35,60,76];



  d3.json("syrirq.json", function(error, uk) {
    svg.selectAll(".subunit")
      .data(topojson.feature(uk, uk.objects.subunits).features)
      .enter().append("path")
        .attr("d", path)
        .attr('class', function(d) { return d.id; })
        .on("mouseover",handleMouseOver)
        .on("mouseout",handleMouseOut);
        

    
    function handleMouseOver(d,i){console.log('ENTER')

          d3.select(".selected").classed("selected", false);
              d3.select(this).classed("selected", true);
              console.log(d.id)
          

              //Mouseover Syria

              if (d.id == "SYX"){
                
                var textbox = svg.append("text")
                  .attr("x", 1015)
                  .attr("y", 85 )
                  .attr("dy", ".35em")
                  .attr('class','test123')
                  .attr('font-size','20px')
                  .text('Syrian Refugees')

                  var ronnie = svg.append('svg:image')
                    .attr('x',450)
                    .attr('y',450)
                    .attr("xlink:href", "/flatronnie.jpg")
                    .attr("width", 150)
                   .attr("height", 200)
                   .attr('class','beer')

                // Set the ranges
                var x = d3.time.scale().range([900, 1200]);
                var y = d3.scale.linear().range([600, 100]);
                var xAxis = d3.svg.axis().scale(x).orient("bottom").ticks(5);
                var yAxis = d3.svg.axis().scale(y).orient("left").ticks(11);

                var parseDate = d3.time.format("%d-%b-%y").parse;
                var valueline = d3.svg.line()
                    .x(function(d) { return x(d.date); })
                    .y(function(d) { return y(d.close); });

                d3.csv("data.csv", function(error, data123) {
                    data123.forEach(function(d) {
                        d.date = parseDate(d.date);
                        d.close = +d.close;});

                x.domain(d3.extent(data123, function(d) { return d.date; }));
                y.domain([0, d3.max(data123, function(d) { return d.close; })]);

                svg.append("path")
                        .attr("class", "line123")
                        .attr("d", valueline(data123));

                svg.append("svg:g")
                            .attr("class", "xaxis")
                            .attr("transform", "translate(0,605)")
                        .call(xAxis);

                svg.append("svg:g")
                            .attr("class", "yaxis")
                            .attr("transform", "translate(890,0)")
                            .call(yAxis);

                var rectangle = svg.append('rect')
                                    .attr('x',892)
                                    .attr('y',100)
                                    .attr('height',502)
                                    .attr('width',320)
                                    .style('opacity',1)
                                    .style('fill','white');


                rectangle.transition()
                        .duration(7000)
                        .ease('linear')
                        .attr('x', 1200)
                        .attr('width',0)

                  });

              


              }

              //Mouseover Iraq

              else if (d.id == "IRR"){
          
               var circle = svg.selectAll('circle')
                .data(data)
                .enter()
                  .append("circle")
                  .attr('cx',750)
                  .attr('cy',275)
                  .attr('r',30)
                  .attr('fill','blue')

                var textbox = svg.append("text")
                  .attr("x", 150)
                  .attr("y", 150)
                  .attr("dy", ".35em")
                  .attr('class','testtext')
                  .text('TESTINGIRAQ!')
                




                }
          
          // Transitions

          ronnie.transition()
                .duration(3500)
                .attr('x', 150)

            } ;
    

    function handleMouseOut(){console.log('EXIT')
        svg.selectAll('circle').remove()
        //svg.selectAll('rect').remove()
        svg.selectAll('text.testtext').remove()
        svg.selectAll('text.test123').remove()
        svg.selectAll('image.beer').remove()
        svg.selectAll('path.line123').remove()
        svg.selectAll('g.xaxis').remove()
        svg.selectAll('g.yaxis').remove()
          };


    svg.append("path")
        .datum(topojson.mesh(uk, uk.objects.subunits, function(a, b) { return a !== b && a.id !== "IRK" || "SYX"; }))
        .attr("d", path)
        .attr("class", "subunit-boundary");

    svg.selectAll(".subunit-label")
      .data(topojson.feature(uk, uk.objects.subunits).features)
      .enter().append("text")
        .attr("class", function(d) { return "subunit-label " + d.id; })
        .attr("transform", function(d) { return "translate(" + path.centroid(d) + ")"; })
        .attr("dy", ".35em")
        .text(function(d) { return d.properties.name; });
  });

  </script>
    </div>
  </section>
</div>

    <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>

        <script src="js/index.js"></script>

    
    
    
  </body>
</html>
